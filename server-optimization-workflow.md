# 서버 최적화 워크플로

## 1단계: 현재 상태 분석 및 백업

### 분석 대상
- uploads 폴더 상세 분석 (625MB)
- 로그 파일 위치 및 크기 확인
- 임시 파일 패턴 파악

### 백업 계획
- 중요 파일 식별 후 static 폴더로 이동
- 데이터베이스 연결 파일들 보존

## 2단계: 즉시 실행 가능한 정리

### uploads 폴더 정리 (목표: 625MB → 100MB)
1. **오래된 임시 파일 제거**
   - 7일 이상된 임시 업로드 파일
   - 실제 사용되지 않는 이미지 파일
   - 중복된 파일명 정리

2. **활성 파일 보존**
   - 현재 DB에서 참조중인 파일들
   - static 폴더로 이동 필요한 파일들

### 로그 파일 정리
1. **시스템 로그 정리**
   - 오래된 에러 로그 압축
   - 디버그 로그 제거
   - 30일 이상 로그 아카이브

2. **애플리케이션 로그 최적화**
   - 불필요한 상세 로그 레벨 조정
   - 로그 로테이션 설정

## 3단계: 자동 정리 시스템 구축

### 자동 정리 스크립트 생성
1. **일일 정리 스크립트**
   - uploads 폴더 7일 이상 파일 자동 삭제
   - 로그 파일 자동 압축
   - 미사용 임시 파일 정리

2. **주간 정리 스크립트**
   - 데이터베이스 참조 검증
   - 고아 파일(orphaned files) 정리
   - 저장공간 사용량 리포트

### 모니터링 시스템
1. **용량 모니터링**
   - 폴더별 용량 추적
   - 임계치 도달 시 알림
   - 자동 정리 실행 로그

2. **성능 모니터링**
   - 디스크 I/O 모니터링
   - 메모리 사용량 추적
   - 응답시간 개선 측정

## 4단계: 실행 및 검증

### 실행 순서
1. 현재 상태 스냅샷 생성
2. 안전한 파일부터 순차적 정리
3. 정리 후 시스템 안정성 확인
4. 자동화 스크립트 배포

### 검증 방법
1. **용량 절약 확인**
   - 정리 전후 용량 비교
   - 목표 달성도 측정
   - 시스템 안정성 확인

2. **기능 무결성 검증**
   - 모든 API 엔드포인트 테스트
   - 이미지/음악 파일 접근 확인
   - 사용자 업로드 기능 테스트

## 예상 효과

### 즉시 효과
- **용량 절약**: 500-600MB (uploads 폴더)
- **성능 향상**: 디스크 I/O 부하 감소
- **안정성 개선**: 불필요한 파일 제거로 시스템 정리

### 장기 효과
- **자동 유지관리**: 수동 개입 없이 최적 상태 유지
- **확장성 확보**: 정리된 환경에서 새 기능 추가 용이
- **모니터링 강화**: 문제 조기 발견 및 대응

## 위험도 평가

### 낮은 위험 (즉시 실행 가능)
- 7일 이상 미사용 임시 파일 삭제
- 압축 가능한 로그 파일 정리
- 중복 파일 제거

### 중간 위험 (신중한 검토 필요)
- DB 참조가 애매한 파일들
- 시스템 설정 관련 파일들
- 사용자 업로드 파일 중 일부

### 높은 위험 (수동 확인 필수)
- 현재 서비스 중인 이미지/음악 파일
- 데이터베이스 백업 파일
- 설정 파일 및 인증서

---

**실행 권장사항**: 낮은 위험 항목부터 단계적 실행 후 검증