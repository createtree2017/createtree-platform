# 전역 모달(Dialog/Sheet 등) 단일화 통폐합 계획서 (Plan)

## 1. 개요 및 배경

- **현황**: 관리자(Admin) 페이지 및 일부 사용자 화면에 총 60여 개의 UI가 중앙(`ModalContext`)을 거치지 않고 개별적(Local State)으로 렌더링되고 있음.
- **문제점**: 이기종 모달 시스템 혼재로 인해 특정 모달(예: 문화센터 검수대기 팝업)에서 브라우저 뒤로가기 시 팝업이 닫히지 않고 뒷배경 라우팅이 이탈하는 심각한 UX 결함 발생. 또한 다중 팝업 시 스크롤 제어(오버레이)가 충돌함.
- **목표**: 프론트엔드 환경 전체(사용자, 관리자)에 존재하는 모든 형태의 모달 기능(Bottom Sheet, Popup Dialog, Alert 등)을 오직 **단일 시스템(`ModalContext`) 안에서 일관성 있게 운용되도록 전수 마이그레이션**하여, "뒤로가기 오류율 0%"를 달성함.

## 2. 작업 스코프 (Scope)

- **대상 파일**: 전체 약 60여 개 이상의 지역 모달 하드코딩 파일.
- **작업 범위**:
  1. 관리자 및 사용자 화면 내 모든 `shadcn/ui` Dialog, Sheet 추출.
  2. 중앙 관제탑 `ModalContext.tsx` 주소창 파싱(로직) 비파괴 강화.
  3. 모든 팝업 컴포넌트를 `openModal()` 함수 호출 구조로 일괄 치환(Drilling 제거).

## 3. 개발 Phase 전략 (단계적 분할 및 안정성 최우선)

**Phase 1: 중앙 관제탑(Core) 코어 강화 및 유스케이스 검증**

- `ModalContext.tsx`의 브라우저 히스토리 이벤트(Popstate) 로직을 수정. 기존 관리자의 복잡한 파라미터(`?tab=culture-center&sub=mission-categories`)를 절대 건드리지 않고, 해시(`HTML Anchors`)만 제어하도록 아키텍처 개조.
- 최상위/최다 빈도 화면인 "검수대기 제출물 상세 모달(`SubmissionDetailModal.tsx`)" 1종을 선행 이식하여 E2E 브라우저 뒤로가기 완벽 호환성 테스트 진행.

**Phase 2: 관리자(Admin) 페이지 모달 전면 치환 (가장 방대함)**

- `MissionManagement`, `MenuManagement`, `GalleryManagement` 등 수십 개의 관리자 라우트 내부에 박혀있는 `<Dialog>` 마크업 분리 및 `useModalContext()` 이관.
- 다중 계층 팝업(모달 안의 모달) 중복 호출 방어 테스트.

**Phase 3: 사용자(User) 및 공통(Common) 컴포넌트 잔여 모달 치환**

- `ConfirmModal`, `GalleryViewerModal` 등 아직 독립화되지 않은 레거시 모달 컴포넌트 분리 및 중앙 통합.
- 사이트 전역의 '단일 아키텍처(Single Source of Truth)' 달성 선언 및 최종 리포트.

## 4. 기대 효과 및 중점 고려사항

- **일관된 UX 제공**: 모든 팝업이 형태에 관계없이 네이티브 앱과 동일한 "뒤로가기 시 닫힘" 생명주기를 완벽히 따름.
- **코드 다이어트**: 의미 없는 `isOpen`, `setIsOpen` 상태(State) 변수 약 100개 이상이 코드베이스에서 일괄 삭제되어 구조가 매우 깨끗해짐.
- **고려사항**: 방대한 지역 Props 전달 방식이 모두 사라지므로, `openModal` 호출부에서 데이터를 유실하지 않도록 인터페이스(Type) 매핑의 정밀한 작업 필수.
