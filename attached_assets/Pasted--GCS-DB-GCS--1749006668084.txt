## ğŸ› ï¸ [ë¼í”Œì´ ì‘ì—…ì§€ì‹œì„œ] GCS ê°¤ëŸ¬ë¦¬ ì´ë¯¸ì§€ í‘œì‹œ ì˜¤ë¥˜ ë° DB/GCS êµ¬ì¡° ë³µì› ì§€ì‹œ

### ğŸ¯ ëª©ì 
- í˜„ì¬ ê°¤ëŸ¬ë¦¬ì—ì„œ ì´ë¯¸ì§€ê°€ ë³´ì´ì§€ ì•Šê±°ë‚˜ ì¤‘ë³µ í‘œì‹œë˜ëŠ” ë¬¸ì œë¥¼ í•´ê²°
- DB ê²½ë¡œì™€ GCS ì €ì¥ êµ¬ì¡°ì˜ ë¶ˆì¼ì¹˜ë¥¼ ì •ë¦¬
- ì •ì‹ì„œë²„ì™€ ê°œë°œì„œë²„ì˜ êµ¬ì¡° ë° ë””ìì¸ì„ í†µì¼í•˜ì—¬ ì‹œìŠ¤í…œ ì •ìƒí™”

---

### âœ… Step 1: DBì˜ ì´ë¯¸ì§€ URL êµ¬ì¡° ë³µì›
- ë‹¤ìŒ ê²½ë¡œ í˜•ì‹ìœ¼ë¡œ DBì˜ `original_url`ê³¼ `thumbnail_url`ì„ ì „ë¶€ ìˆ˜ì •:
  ```
  https://storage.googleapis.com/createtree-upload/images/{category}/{userId}/{filename}.webp
  https://storage.googleapis.com/createtree-upload/images/{category}/{userId}/thumbnails/{filename}.webp
  ```
- ìˆ˜ì • ëŒ€ìƒ: `images` í…Œì´ë¸”ì˜ ëª¨ë“  ë ˆì½”ë“œ
- `uploads/...` ë˜ëŠ” `images/general/system/...` í˜•ì‹ì€ **ëª¨ë‘ ì œê±°**

---

### âœ… Step 2: GCS íŒŒì¼ í™•ì¸ ë° ê²½ë¡œ ì¼ì¹˜ ê²€ì¦
- `/server/scripts/check-gcs-files.ts` ì‚¬ìš©
  - DBì—ì„œ ì‚¬ìš©ëœ ëª¨ë“  `original_url`, `thumbnail_url`ì„ ì¶”ì¶œ
  - ì‹¤ì œ GCS ë²„í‚·ì— ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
- ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íŒŒì¼ì€ **ì ˆëŒ€ ì„ì˜ë¡œ ìƒì„±í•˜ì§€ ë§ê³ **, í•´ë‹¹ ë ˆì½”ë“œë¥¼ DBì—ì„œ ì œì™¸

---

### âœ… Step 3: ê°¤ëŸ¬ë¦¬ API ë°˜í™˜ êµ¬ì¡° ì›ìƒë³µêµ¬
- `/server/routes.ts` ë˜ëŠ” `/api/gallery` ë‚´ ë°˜í™˜ í˜•ì‹:
  ```ts
  {
    items: [
      {
        id: number,
        title: string,
        original_url: string,
        thumbnail_url: string,
        created_at: string,
        category: string,
        ...ê¸°íƒ€ í•„ë“œ
      }
    ]
  }
  ```
- í˜„ì¬ `{images: [...]}` ë˜ëŠ” `[]` ë°°ì—´ ìì²´ ë°˜í™˜ êµ¬ì¡°ëŠ” ëª¨ë‘ ì œê±°
- `React Query`ì—ì„œ `enabled: !!user` ì¡°ê±´ì€ ì œê±° ìœ ì§€ ê°€ëŠ¥, ë‹¤ë§Œ **ë°ì´í„° êµ¬ì¡°ëŠ” ì›ìƒë³µêµ¬**

---

### âœ… Step 4: ì¤‘ë³µ ì´ë¯¸ì§€ ìë™ ìƒì„± ë¡œì§ ì œê±°
- ë‹¤ìŒ ìŠ¤í¬ë¦½íŠ¸ëŠ” ì‚­ì œ ë˜ëŠ” ì£¼ì„ ì²˜ë¦¬:
  - `/scripts/create-diverse-gallery.ts`
  - `/scripts/upload-missing-images.ts`
- DBì— ë™ì¼í•œ `original_url`ë¡œ ì—¬ëŸ¬ ê°œ ìƒì„±ëœ ë ˆì½”ë“œ ëª¨ë‘ ì‚­ì œ
- ë‹¨ì¼ ëŒ€í‘œ ì´ë¯¸ì§€ë§Œ ìœ ì§€ (titleì´ ë‹¤ë¥¸ ê²½ìš°ë¼ë„ ë™ì¼ ì´ë¯¸ì§€ë©´ ì‚­ì œ)

---

### âœ… Step 5: í”„ë¡ íŠ¸ ê°¤ëŸ¬ë¦¬ UI ë³µì›
- ê¸°ì¤€ì€ ì •ì‹ì„œë²„ UI (íšŒìƒ‰ ë°°ê²½ + ì¹´ë©”ë¼ ì•„ì´ì½˜ + í…ìŠ¤íŠ¸ í¬í•¨):
  - placeholder: `bg-gray-200` + `items-center justify-center`
  - í…ìŠ¤íŠ¸: `"ì´ë¯¸ì§€ë¥¼ ì¤€ë¹„ ì¤‘"`, ì´ë¯¸ì§€ ë¡œë“œ ì „ í‘œì‹œ
  - grid: `2 x 4` êµ¬ì¡° ìœ ì§€
- ì´ë¯¸ì§€ ë¡œë”© ì‹¤íŒ¨ ì‹œ fallback UI ì ìš©

---

### â›” ì ˆëŒ€ í•˜ì§€ ë§ ê²ƒ
- GCS ê²½ë¡œë¥¼ ì—…ë¡œë“œ ê¸°ì¤€ìœ¼ë¡œ ì„ì˜ë¡œ ë°”ê¾¸ì§€ ë§ ê²ƒ (`uploads/` ì œê±°)
- `createtree-upload` ì™¸ ë‹¤ë¥¸ ë²„í‚· ì‚¬ìš© ê¸ˆì§€
- OpenAI API í‚¤ ë³€ê²½ ê¸ˆì§€ (`sk-proj-` ê³ ì •, ì¼ë°˜ `sk-` í‚¤ ì ˆëŒ€ ê¸ˆì§€)

---

### ğŸ” í…ŒìŠ¤íŠ¸ ì‹œ ìœ ì˜ì‚¬í•­
- ì‚¬ìš©ì ID: 24 ê¸°ì¤€ìœ¼ë¡œ í…ŒìŠ¤íŠ¸
- `/api/gallery?type=images` í˜¸ì¶œ ì‹œ `12ê°œ ì´ë¯¸ì§€`ê°€ GCSì™€ DB ëª¨ë‘ ì¼ì¹˜í•´ì•¼ ì„±ê³µ
- ë¸Œë¼ìš°ì € ì½˜ì†” ì—ëŸ¬ `401`, `null.innerHTML`, `ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨` ë“±ì´ ë‚˜íƒ€ë‚˜ë©´ ì¦‰ì‹œ ì¤‘ë‹¨í•˜ê³  ë¡œê·¸ í™•ì¸