Sentry ì›¹ì‚¬ì´íŠ¸ì˜ "Welcome to Sentry" í™”ë©´ì—ì„œ ë‹¤ìŒ ë‹¨ê³„ë¥¼ ì§„í–‰í•´ ì£¼ì„¸ìš”. ğŸš€

## Sentry ì ìš©ì„ ìœ„í•œ ì´ˆê¸° ë‹¨ê³„

ì œê³µí•´ì£¼ì‹  ì‹œìŠ¤í…œ ëª…ì„¸ì„œì— ë”°ë¥´ë©´ ê·€í•˜ì˜ í”„ë¡œì íŠ¸ëŠ” **Node.js (Express.js)** ê¸°ë°˜ì˜ ë°±ì—”ë“œì™€ **React (TypeScript)** ê¸°ë°˜ì˜ í”„ë¡ íŠ¸ì—”ë“œë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤. Sentryë¥¼ ì™„ì „íˆ ì ìš©í•˜ë ¤ë©´ ì´ ë‘ í™˜ê²½ì— ê°ê° Sentry SDKë¥¼ ì„¤ì¹˜í•˜ê³  êµ¬ì„±í•´ì•¼ í•©ë‹ˆë‹¤.

### 1\. Sentry í”„ë¡œì íŠ¸ ìƒì„± ë° ì–¸ì–´ ì„ íƒ

1.  **"Start" ë²„íŠ¼ í´ë¦­:** í™”ë©´ ì¤‘ì•™ì˜ **"Start"** ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì„¤ì •ì„ ì‹œì‘í•©ë‹ˆë‹¤.
2.  **í”„ë¡œì íŠ¸ ìœ í˜• ì„ íƒ (ë‘ ë²ˆ ì§„í–‰):** SentryëŠ” í”„ë¡œì íŠ¸ì˜ ì–¸ì–´ë‚˜ í”„ë ˆì„ì›Œí¬ì— ë§ëŠ” ì „ìš© SDKë¥¼ ì œê³µí•©ë‹ˆë‹¤.
      * **ë°±ì—”ë“œ(Backend):**
          * ì–¸ì–´/í”„ë ˆì„ì›Œí¬ ëª©ë¡ì—ì„œ \*\*"Node.js"\*\*ë¥¼ ì„ íƒí•©ë‹ˆë‹¤. (Express.jsìš© ì„¤ì •ì´ ì œê³µë©ë‹ˆë‹¤.)
      * **í”„ë¡ íŠ¸ì—”ë“œ(Frontend):**
          * **"React"** ë˜ëŠ” \*\*"JavaScript"\*\*ë¥¼ ì„ íƒí•©ë‹ˆë‹¤. (React/TypeScript í™˜ê²½ì— ì í•©í•œ ì„¤ì •ì´ ì œê³µë©ë‹ˆë‹¤.)

### 2\. ë°±ì—”ë“œ (Express/Node.js) ì„¤ì • ğŸ› ï¸

API ì„œë²„ì—ì„œ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜(500 ì—ëŸ¬, DB ì—°ê²° ì˜¤ë¥˜, AI API í˜¸ì¶œ ì‹¤íŒ¨ ë“±)ë¥¼ ì¶”ì í•©ë‹ˆë‹¤.

1.  **SDK ì„¤ì¹˜:**

    ```bash
    npm install @sentry/node @sentry/integrations
    ```

2.  **ì´ˆê¸°í™” (`index.ts` ë˜ëŠ” `routes.ts` íŒŒì¼):**

      * Sentryì—ì„œ ì œê³µí•˜ëŠ” DSN(Data Source Name) í‚¤ë¥¼ ì‚¬ìš©í•˜ì—¬ Express ì„œë²„ ì§„ì…ì (`server/index.ts` ë˜ëŠ” `server/routes.ts` ê·¼ì²˜)ì— ì´ˆê¸°í™” ì½”ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.

    <!-- end list -->

    ```typescript
    import * as Sentry from '@sentry/node';
    import { Integrations as HttpIntegrations } from '@sentry/integrations'; // HTTP ìš”ì²­ ì¶”ì ì„ ìœ„í•´

    // .env íŒŒì¼ ë“±ì—ì„œ DSN ê°€ì ¸ì™€ ì‚¬ìš©
    Sentry.init({
      dsn: "YOUR_SENTRY_DSN", 
      integrations: [
        new HttpIntegrations.Http({ tracing: true }),
        // ... í•„ìš”í•œ Express í†µí•© ê¸°ëŠ¥ ì¶”ê°€
      ],
      // release: '1.0.0', // ë°°í¬ ë²„ì „ ê´€ë¦¬
      environment: process.env.NODE_ENV || 'development',
    });

    // Express app ë¯¸ë“¤ì›¨ì–´ ì¶”ê°€ (ê°€ì¥ ë¨¼ì €)
    app.use(Sentry.Handlers.requestHandler());

    // ... ëª¨ë“  routes ë° middleware

    // Express app ë¯¸ë“¤ì›¨ì–´ ì¶”ê°€ (ê°€ì¥ ë§ˆì§€ë§‰, ì—ëŸ¬ í•¸ë“¤ëŸ¬ ì•)
    app.use(Sentry.Handlers.errorHandler()); 
    ```

3.  **ì‚¬ìš©ì ì •ë³´ ì—°ë™:**

      * ì¸ì¦ ë¯¸ë“¤ì›¨ì–´(`server/middleware/auth.ts`)ì—ì„œ JWT ê²€ì¦ í›„ `req.user` ì •ë³´ê°€ í™•ë³´ë˜ë©´, Sentryì— ì‚¬ìš©ì ì •ë³´ë¥¼ ë“±ë¡í•˜ì—¬ íŠ¹ì • ì—ëŸ¬ê°€ **ì–´ë–¤ ì‚¬ìš©ì**ì—ê²Œì„œ ë°œìƒí–ˆëŠ”ì§€ ì¶”ì í•©ë‹ˆë‹¤.

    <!-- end list -->

    ```typescript
    Sentry.setUser({
      id: req.user.id,
      email: req.user.email,
      memberType: req.user.memberType,
      hospitalId: req.user.hospitalId,
    });
    ```

### 3\. í”„ë¡ íŠ¸ì—”ë“œ (React) ì„¤ì • ğŸ’»

ì‚¬ìš©ì ë¸Œë¼ìš°ì €ì—ì„œ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜(UI ë Œë”ë§ ì‹¤íŒ¨, API ì‘ë‹µ ì²˜ë¦¬ ì˜¤ë¥˜, í´ë¼ì´ì–¸íŠ¸ ì¸¡ JavaScript ì—ëŸ¬)ë¥¼ ì¶”ì í•©ë‹ˆë‹¤.

1.  **SDK ì„¤ì¹˜:**

    ```bash
    npm install @sentry/react
    ```

2.  **ì´ˆê¸°í™” (`client/src/App.tsx` ë˜ëŠ” ë©”ì¸ ì§„ì… íŒŒì¼):**

      * `client/src/App.tsx` ë“± ë©”ì¸ ì»´í¬ë„ŒíŠ¸ ê·¼ì²˜ì—ì„œ Sentryë¥¼ ì´ˆê¸°í™”í•˜ê³ , `ErrorBoundary`ë¡œ ì•±ì„ ê°ì‹¸ì¤ë‹ˆë‹¤.

    <!-- end list -->

    ```typescript
    import * as Sentry from "@sentry/react";
    import { Integrations } from "@sentry/tracing"; // ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ì„ ìœ„í•´
    import App from './App.tsx'; // ë©”ì¸ ì•± ì»´í¬ë„ŒíŠ¸

    Sentry.init({
      dsn: "YOUR_SENTRY_DSN",
      integrations: [
        new Integrations.BrowserTracing({
            // Wouter ë¼ìš°íŒ…ì„ ì‚¬ìš©í•˜ë¯€ë¡œ, ë¼ìš°íŠ¸ ë³€ê²½ì„ ì¶”ì 
            routingInstrumentation: Sentry.reactRouterV5Instrumentation(useLocation, history), 
        }),
      ],
      tracesSampleRate: 1.0, // ì„±ëŠ¥ ì¶”ì  í™œì„±í™” (í”„ë¡œë•ì…˜ì—ì„œëŠ” 0.1~0.5 ê¶Œì¥)
    });

    // ë©”ì¸ ì•±ì„ Sentry.ErrorBoundaryë¡œ ê°ì‹¸ í´ë¼ì´ì–¸íŠ¸ ì—ëŸ¬ë¥¼ í¬ì°©í•©ë‹ˆë‹¤.
    const Root = () => (
      <Sentry.ErrorBoundary fallback={<div>ì£„ì†¡í•©ë‹ˆë‹¤. ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>}>
        <App />
      </Sentry.ErrorBoundary>
    );

    // ReactDOM.createRoot(document.getElementById('root')!).render(<Root />);
    ```

3.  **ìƒíƒœ ê´€ë¦¬ ì—°ë™:**

      * `TanStack Query`ë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ, ì „ì—­ ì—ëŸ¬ í•¸ë“¤ë§ì„ í†µí•´ API ìš”ì²­ ì‹¤íŒ¨ë¥¼ Sentryë¡œ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    <!-- end list -->

    ```typescript
    import { QueryClient } from '@tanstack/react-query';

    const queryClient = new QueryClient({
      defaultOptions: {
        queries: {
          onError: (error) => {
            // ëª¨ë“  TanStack Query ì‹¤íŒ¨ ì‹œ Sentryë¡œ ì „ì†¡
            Sentry.captureException(error); 
          },
        },
      },
    });
    ```